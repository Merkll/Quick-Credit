language: node_js
services:
  - postgresql
env:
  global:
    - CC_TEST_REPORTER_ID=c37b0267018af1c803858f8ba98a105c49a2accc776dc06673333fa147312330
    - NODE_ENV=test
    - DB=testdb
node_js:
- node
before_script:
  - yarn global add nyc
  - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
  - chmod +x ./cc-test-reporter
  - ./cc-test-reporter before-build
  - psql -c "CREATE DATABASE testdb;" -U postgres
install:
- npm install

script:
- npm run test
cache:
  directories:
  - node_modules
after_success: 
  - npm run coveralls
  - npm run coverage
after_script:
  - ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT
# branches:
#   only:
#   - master
#   - develop
deploy:
  provider: heroku
  api_key:
    secure: mdibnismOlpnjG+MuXIRf54HNRLqgGHY/9pN+9lUh7iQzhAcqHDPDaIx1Z66E8tmWEtl8Xc/twu4+7TpmKv52Yv20yElt4vYybE03cHJ++WFoLOr4Biq71IKPxfHqnKez9BEXJ1ztgwhJEVKxyPg6/RnUFkEDXRd5WuA5uJovqKk8CrqnPVmLrjvuwTTBaZZMutvRnemAODQLl+grbtMWotpYjJp/Kop2alIzU+WaY8KAE8jkdHsxpS3LxtnsWVFp4jY7E10cd3E16lVutJhEOTURulyuopyPkMaBycKIh+P3ynVKwfieSP48uPaAmbOYE4WADzjtieYoUZX7xqlc5UyuUh0hXm0hxNuYrhUEtsNS3k7AeT4X573f4Wc14xadCELajX3xoEs+pMJMj5JGrZoRR1Oz9oIIFgttpk/aC/nXiD8ze0eUqwk+638SuXdDogJFXo6D6MzlwuYcqg3x5quhBHC6ikEdEWpv9h4ImKQoXtDXiWySeRsKvbAIt5XrstLuhf8oRD6Bh+pu7bNZyyM4yTtetx1kIsiG+rW5GyBb4Fd9qJPNjVpKb4hlPa/+tOrg+dHSzEBeVMtkHmmRBXIQI2wTYgBBOfpIN4QxtcR2AvbGJyVW/NSfK+ak5wp543mQyZT4jxbIEvpw4rqXWAbP+KsqNEbtO5RhNF5r8Q=
  app:
    master: quick-credit-production
    develop: quick-credit-staging
  